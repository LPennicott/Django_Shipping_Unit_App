
<!-- Record Detail Modal Content -->
<div class="modal-header">
  <h5 class="modal-title">{{ record.name }}'s Details</h5>
  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
</div>
<div class="modal-body">
  <p><strong>Email:</strong> {{ record.email }}</p>
  <p><strong>Phone:</strong> {{ record.phone }}</p>
  <p><strong>Age:</strong> {{ record.age }}</p>
  <p><strong>Level:</strong> {{ record.level }}</p>
  <p><strong>Active:</strong> {{ record.active|yesno:"Yes,No" }}</p>
  <p><strong>Competitive:</strong> {{ record.competitive|yesno:"Yes,No" }}</p>
  <p><strong>Challenges:</strong> {{ record.challenges }}</p>
  <p><strong>Resources:</strong> {{ record.resources }}</p>
  <p><strong>Recommendations:</strong> {{ record.recommendations }}</p>
</div>
<div class="modal-footer">
  <button
    type="button"
    class="btn btn-outline-primary open-edit-from-detail"
    data-url="{% url 'records:record_edit' record.pk %}">
    Edit
  </button>



  <button
    type="button"
    class="btn btn-outline-danger"
    data-bs-toggle="modal"
    data-bs-target="#deleteModal"
    data-record-id="{{ record.pk }}"
    data-record-name="{{ record.name }}">
    Delete
  </button>

  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
</div>
<script>
document.addEventListener("DOMContentLoaded", function () {
  const detailModal = document.getElementById("detailModal");
  const editModal = document.getElementById("editModal");
  const editModalBody = document.getElementById("editModalBody");

  document.body.addEventListener("click", function (event) {
    if (event.target.classList.contains("open-edit-from-detail")) {
      const editUrl = event.target.getAttribute("data-url");

      // Close the detail modal
      const detailInstance = bootstrap.Modal.getInstance(detailModal);
      detailInstance.hide();

      // After modal is hidden, load and show the edit modal
      detailModal.addEventListener("hidden.bs.modal", function handler() {
        fetch(editUrl, {
          headers: { "X-Requested-With": "XMLHttpRequest" }
        })
        .then(response => response.json())
        .then(data => {
          editModalBody.innerHTML = data.html;
          const editInstance = new bootstrap.Modal(editModal);
          editInstance.show();
        });

        // Remove this one-time event listener
        detailModal.removeEventListener("hidden.bs.modal", handler);
      });
    }
  });
});
</script>
